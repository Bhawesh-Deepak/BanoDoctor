function initDatePicker(){$(".date-picker4").datepicker({dateFormat:"mm/dd/yy",constrainInput:!0,beforeShow:function(){},onClose:function(){}}).on("change",function(){var n=$(this).attr("ID"),t;return $(this).val()==""||$(this).val()=="mm/dd/yyyy"?(n=="EffectiveDate"?$('Span[data-valmsg-for="EffectiveDate"]').html(""):$('Span[data-valmsg-for="TerminationDate"]').html(""),!0):(t=Date.parse(checkdate($(this).val())),/Invalid|NaN/.test(t)?(n=="EffectiveDate"?$('Span[data-valmsg-for="EffectiveDate"]').html("<span for='EffectiveDate' generated='true'>Please enter date in mm/dd/yyyy format.<\/span>"):$('Span[data-valmsg-for="TerminationDate"]').html("<span for='TerminationDate' generated='true'>Please enter date in mm/dd/yyyy format.<\/span>"),!1):(n=="EffectiveDate"?$('Span[data-valmsg-for="EffectiveDate"]').html(""):$('Span[data-valmsg-for="TerminationDate"]').html(""),!0))});$.validator.addMethod("date-picker4",function(n,t){if(n!=""&&n!="mm/dd/yyyy"){var i=Date.parse(checkdate(n));return/Invalid|NaN/.test(i)?!1:(t.id=="EffectiveDate"?$('Span[data-valmsg-for="EffectiveDate"]').html(""):$('Span[data-valmsg-for="TerminationDate"]').html(""),!0)}return!0},"Please enter date in mm/dd/yyyy format.")}$(document).ready(function(){client.fn_ClientListOnLoad();$("#PlanRuleSetID").change(function(){$(this).val()>0&&$("#spnMsgPlanRuleSetID").text("")})});var client={fn_ClientListOnLoad:function(){var n={};n.ClientName="";n.NABP=commanAjax.fn_GetUrlVars().strValue;n.NPI="";n.id=null;$.ajax({type:"POST",url:"/Client/GetClientList",data:n,success:function(n){n.search("sessionModel")>0?location.reload():($("#dvClaimPartial").html(""),$("#dvClaimPartial").html(n))}})},fn_ClientListFilter:function(){var n={};n.ClientName=$("#txtClientName").val();n.NABP=$("#txtPharmacyID").val();n.NPI=$("#txtNPI").val();n.id=(new Date).getMilliseconds();$.ajax({type:"POST",url:"/Client/GetClientList",data:n,success:function(n){n.search("sessionModel")>0?location.reload():($("#dvPharmacyPartial").html(""),$("#dvPharmacyPartial").html(n))}})},fn_UpsertMemberPlan:function(n,t,i){$("#dvClientFacilityPartial").addClass("ajaxLoading");$.get("/Client/UpsertPharmacyRatePlan",{PharmacyId:n,PlanId:i},function(n){n.search("sessionModel")>0?location.reload():$("#divPartialEditPlan").html(n)}).done(function(){i>0?$("#modalTitle").text("Edit Facility Plan"):$("#modalTitle").text("Add Facility Plan");$("#clientEditPlanModal").modal("show");initDatePicker();$("#dvClientFacilityPartial").removeClass("ajaxLoading")})},fn_BindFacilityPlan:function(n){var t={};t.FacilityID=n;$("#dvClientFacilityPartial").addClass("ajaxLoading");$.ajax({type:"POST",url:"/Client/GetFacilityPlans",data:t,success:function(n){n.search("sessionModel")>0?location.reload():($("#divPartialViewPlan").html(n),commanAjax.fn_SetActiveFirstRow("#tblFacilityPlan"),$("#clientViewPlanModal").modal("show"),$("#modalSize").removeClass().addClass("modal-dialog lg"),$("#dvClientFacilityPartial").removeClass("ajaxLoading"))}})},fn_BindPlanPricingRule:function(n,t,i){if($.each($("#tblFacilityPlan a.minus"),function(n,t){$(t).attr("data-ref")!==$(i).attr("data-ref")&&($("#trMemberPlanPricingRule_"+$(t).attr("data-ref")).slideUp(),$(t).removeClass("minus"))}),$(i).hasClass("minus"))$("#dvMemberPlanPricingRule_"+n).html(""),$("#trMemberPlanPricingRule_"+n).slideUp("slow","linear",function(){$(i).removeClass("minus")});else{var r={};r.ClientBasicRuleSetID=t;$("#divPartialViewPlan").addClass("ajaxLoading");$.ajax({type:"POST",url:"/Client/GetPlanPricingRuleForPharmacy",data:r,success:function(t){t.search("sessionModel")>0?location.reload():($("#dvMemberPlanPricingRule_"+n).html(t),$("#trMemberPlanPricingRule_"+n).slideDown(),$(i).addClass("minus"),$("#divPartialViewPlan").removeClass("ajaxLoading"))}})}},fn_RatePlanIdValidation:function(){return $("#PlanRuleSetID").val()==0?($("#spnMsgPlanRuleSetID").text("Please Select Plan"),!1):($("#spnMsgPlanRuleSetID").text(""),!CheckTermDate())?!1:!0},fn_DateValidation:function(){return CheckTermDate()?($("#TerminationDate").removeClass("input-validation-error").addClass("valid"),!0):($("#TerminationDate").removeClass("valid").addClass("input-validation-error"),!1)},fn_PharmacyRatePlanValidation:function(){var n=!1;return $("#PlanRuleSetID").val()==0?($("#spnMsgPlanRuleSetID").text("Please Select Plan"),n=!1):(n=!0,$("#spnMsgPlanRuleSetID").text("")),n==!0&&($("#EffectiveDate").val()==""?($("#spnMsgEffectiveDate").text("Please Enter Effective Date"),n=!1):(n=!0,$("#spnMsgEffectiveDate").text(""))),n==!0&&($("#TerminationDate").val()==""?($("#spnMsgTerminationDate").text("Please Enter Termination Date"),n=!1):(n=!0,$("#spnMsgTerminationDate").text(""))),CheckTermDate()||(n=!1),n},fn_UpsertPharmacyRatePlan:function(){var t=!1,n;return client.fn_PharmacyRatePlanValidation()&&(t=!0,n={},n.PharmacyID=$("#PharmacyID").val(),n.PharmacyPlanID=$("#PharmacyPlanID").val(),n.PlanRuleSetID=$("#PlanRuleSetID").val(),n.EffectiveDate=$("#EffectiveDate").val(),n.TerminationDate=$("#TerminationDate").val(),$.ajax({type:"POST",url:"/Client/UpsertPharmacyRatePlan",data:n,success:function(n){n.search("sessionModel")>0?location.reload():n.messageId>0&&(commanAjax.Fn_CommanAlert(n.message,"Alert!"),$("#THSCommanModalPopUp").modal("hide"),location.reload())}})),t},fn_GetUrl:function(){return"/Client/GetClientList"},fn_GetInnerUrl:function(){return"/Client/PharmacyFacility"},fn_GetClientDetails:function(n){$.get("/Client/PharmacyDetails",{pharmacyId:n},function(n){n.search("sessionModel")>0?location.reload():($("#modalSize").removeClass().addClass("modal-dialog lg"),$("#divPartialData").html(n),$("#THSCommanModalPopUp").modal("show"))})},fn_UpsertPharmacyRatePlanBegin:function(){return client.fn_DateValidation()},fn_UpsertPharmacyRatePlanSuccess:function(n){$("#divPartialEditPlan").removeClass("ajaxLoading");commanAjax.Fn_CommanAlert(n.message,"Alert!");n.returnId==1&&($("#clientEditPlanModal").modal("hide"),client.fn_BindFacilityPlan(n.id))},fn_UpsertClaimBegin:function(){$("#divPartialEditPlan").addClass("ajaxLoading")},fn_UpsertClaimSuccess:function(n){n.search("sessionModel")>0?location.reload():($("#divPartialEditPlan").removeClass("ajaxLoading"),commanAjax.Fn_CommanAlert(n.message,"Alert!"),$("#clientEditPlanModal").modal("hide"),client.fn_BindFacilityPlan(n.id))},fn_GetLoadingDiv:function(){return"#divClaimFacilityList"},fn_BidFacility:function(n,t){$("#dvClaimPartial").addClass("ajaxLoading");$("#modalHeader").html("Pharmacy Facilities ("+t+")");var i={};i.PharmacyID=n;$.ajax({type:"POST",url:"/Client/PharmacyFacility",data:i,success:function(n){n.search("sessionModel")>0?location.reload():($("#dvClientFacilityHeading").show(),$("#dvClientFacilityPartial").html(n),commanAjax.fn_SetActiveFirstRow("#tblPharmacyFacility"),$("#THSClientFacilityModel").modal("show"),$("#dvClaimPartial").removeClass("ajaxLoading"))}})},fn_CloseCurrentModel:function(n){setTimeout(function(){$(n).find("tbody tr:first")!=undefined&&$(n+" tbody tr:first").find("td").length>1&&$(n+" tr.selected").click()},100)}};$(document).delegate("#btnCancel","click",function(){$("#THSCommanModalPopUp").modal("hide")});