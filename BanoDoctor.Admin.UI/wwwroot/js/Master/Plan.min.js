function ClientIdValidation(){if($("#PriceSourceOptionID option:selected").text()=="DRUGLIST"||$("#PriceSourceOptionID option:selected").text()=="MAC"){if($("#PriceBasicDrugListID").val()==0)return $("#spnMsgPriceBasicDrugListID").text("Please Select Drug List"),!1;$("#spnMsgPriceBasicDrugListID").text("")}else $("#spnMsgPriceBasicDrugListID").text("");return!0}$(function(){$(".date-picker3").datepicker({dateFormat:"mm/dd/yy",constrainInput:!0,beforeShow:function(){},onClose:function(){}}).on("change",function(){var n=$(this).attr("ID"),t;return $(this).val()==""||$(this).val()=="mm/dd/yyyy"?(n=="EffectiveDate"?$('Span[data-valmsg-for="EffectiveDate"]').html(""):$('Span[data-valmsg-for="TerminationDate"]').html(""),!0):(t=Date.parse(checkdate($(this).val())),/Invalid|NaN/.test(t)?(n=="EffectiveDate"?$('Span[data-valmsg-for="EffectiveDate"]').html("<span for='EffectiveDate' generated='true'>Please enter date in mm/dd/yyyy format.<\/span>"):$('Span[data-valmsg-for="TerminationDate"]').html("<span for='TerminationDate' generated='true'>Please enter date in mm/dd/yyyy format.<\/span>"),!1):(n=="EffectiveDate"?$('Span[data-valmsg-for="EffectiveDate"]').html(""):$('Span[data-valmsg-for="TerminationDate"]').html(""),!0))});$.validator.addMethod("date-picker3",function(n,t){if(n!=""&&n!="mm/dd/yyyy"){var i=Date.parse(checkdate(n));return/Invalid|NaN/.test(i)?!1:(t.id=="EffectiveDate"?$('Span[data-valmsg-for="EffectiveDate"]').html(""):$('Span[data-valmsg-for="TerminationDate"]').html(""),!0)}return!0},"Please enter date in mm/dd/yyyy format.");$.validator.addMethod("OnlyChar",function(n){if(n!="")return/^[a-zA-Z]*$/.test(n)?!0:!1},"Number and space are not allowed.");$.validator.addMethod("OnlyNum",function(n){if(n!="")return/^[0-9\b]+$/.test(n)?!0:!1},"Character and space are not allowed.");$.validator.addMethod("OnlyDec",function(n){if(n!="")return/^\d+(\.\d{1,2})?$/.test(n)?!0:!1},"Character and space are not allowed.")});$(document).ready(function(){$("#BGindicator").change(function(){$(this).val()!=-1&&$("#spnMsgBGindicator").text("")});$("#PriceComparisonID").change(function(){$(this).val()!=-1&&$("#spnMsgPriceComparisonID").text("")});$("#txtRate").on("keypress",function(n){n.keyCode==13&&$("#search").click()});planMaster.fn_BindListOnLoad()});var planMaster={fn_BindListOnLoad:function(){var n={};$("#SearchForm").serializeArray().map(function(t){n[t.name]=t.value});$.post("/Plan/FilteredPlanList",{searchModelEntity:n,sortBy:"",pageIndex:1},function(n){n.search("sessionModel")>0?location.reload():($("#dvClaimPartial").html(""),$("#dvClaimPartial").html(n))})},fn_BindPlanPricingRule:function(n){$("#divClaimList").addClass("ajaxLoading");$.get("/Plan/GetPlanPricingRule",{ClientBasicRuleSetID:n},function(n){n.search("sessionModel")>0?location.reload():($("#modalSize").removeClass().addClass("modal-dialog lg"),$("#divPartialData").html(n),commanAjax.fn_SetActiveFirstRow("#tblPlanPricingRule"),$("#THSCommanModalPopUp").modal("show"))}).done(function(){$("#divClaimList").removeClass("ajaxLoading")})},fn_filterPlan:function(){var n={};n.strValue=$("#txtRatePlan").val();n.id=(new Date).getMilliseconds();$.ajax({type:"POST",url:"/Plan/FilteredPlanList",data:n,success:function(n){n.search("sessionModel")>0?location.reload():($("#dvRatePartial").html(""),$("#dvRatePartial").html(n))}})},fn_DeleteRatePlanPriceRule:function(n,t){$.confirm({title:"Confirm",content:"Are you sure, You want to delete the selected price rule?",typeAnimated:!0,draggable:!1,buttons:{ok:{text:"Yes",btnClass:"btn-blue",keys:["enter"],action:function(){$("#hdnPlanId").val(n);var i={};i.ClientBasicRuleSetID=n;i.ClientBasicRulePriceID=t;$("#divPartialData").addClass("ajaxLoading");$.ajax({type:"POST",url:"/Plan/DeleteRatePlanPriceRule",data:i,success:function(t){t.messageId>0&&(commanAjax.Fn_CommanAlert(t.message,"Alert!"),planMaster.fn_BindPlanPricingRule(n),$("#divPartialData").removeClass("ajaxLoading"))}})}},cancel:{text:"No",btnClass:"btn-dark",action:function(){}}}})},fn_RatePlanValidation:function(){var n=!0,t=$("#frmUpsertRatePlan").valid();return t||(n=!1),n},fn_DateValidation:function(){return CheckTermDate()?($("#TerminationDate").removeClass("input-validation-error").addClass("valid"),!0):($("#TerminationDate").removeClass("valid").addClass("input-validation-error"),!1)},fn_UpsertRatePlanBegin:function(){return planMaster.fn_DateValidation()},fn_UpsertRatePlan:function(){var t=!1,n;return planMaster.fn_RatePlanValidation()&&(t=!0,n={},n.ClientBasicRuleSetID=$("#ClientBasicRuleSetID").val(),n.ClientMemberPlanName=$("#ClientMemberPlanName").val(),n.PriceBasicDrugListID=$("#PriceBasicDrugListID").val(),n.BGindicator=$("#BGindicator").val(),n.PriceComparisonID=$("#PriceComparisonID").val(),n.DaySupplyEdit=$("#DaySupplyEdit").val(),n.QuantityEdit=$("#QuantityEdit").val(),n.EarlyRefillEdit=$("#EarlyRefillEdit").val(),n.MaximumDollarEdit=$("#MaximumDollarEdit").val(),n.EffectiveDate=$("#EffectiveDate").val(),n.TerminationDate=$("#TerminationDate").val(),n.PlanNumber=$("#PlanNumber").val(),n.MinimumDollarEdit=$("#MinimumDollarEdit").val(),$.ajax({type:"POST",url:"/Plan/UpsertRatePlan",data:n,success:function(n){n.search("sessionModel")>0?location.reload():n.messageId>0&&(commanAjax.Fn_CommanAlert(n.message,"Alert!"),window.location.href="/Plan/PlanList?strValue=")}})),t},fn_ClientIdValidation:function(){if($("#PriceSourceOptionID option:selected").text()=="DRUGLIST"||$("#PriceSourceOptionID option:selected").text()=="MAC"){if($("#PriceBasicDrugListID").val()==0)return $("#spnMsgPriceBasicDrugListID").text("Please Select Drug List"),!1;$("#spnMsgPriceBasicDrugListID").text("")}else $("#spnMsgPriceBasicDrugListID").text("");return!0},fn_UpsertRatePlanPriceRuleBegin:function(){var n=!0;return $("#PriceSourceOptionID").val()==0?($("#PriceSourceOptionID").removeClass("valid").addClass("input-validation-error"),n=!1):$("#PriceSourceOptionID").removeClass("input-validation-error").addClass("valid"),($("#PriceSourceOptionID option:selected").text()=="DRUGLIST"||$("#PriceSourceOptionID option:selected").text()=="MAC")&&($("#PriceBasicDrugListID").val()==0?($("#PriceBasicDrugListID").removeClass("valid").addClass("input-validation-error"),n=!1):$("#PriceBasicDrugListID").removeClass("input-validation-error").addClass("valid")),n},fn_PriceSourceOptionIdOnChange:function(){$("#PriceSourceOptionID").val()==0?$("#PriceSourceOptionID").removeClass("valid").addClass("input-validation-error"):$("#PriceSourceOptionID").removeClass("input-validation-error").addClass("valid");$("#PriceSourceOptionID option:selected").text()=="DRUGLIST"||$("#PriceSourceOptionID option:selected").text()=="MAC"?$("#fldDrugList").show():($("#fldDrugList").hide(),$("#PriceBasicDrugListID").val("0"))},fn_PriceBasicDrugListIdOnChange:function(){$("#PriceBasicDrugListID").val()==0?$("#PriceBasicDrugListID").removeClass("valid").addClass("input-validation-error"):$("#PriceBasicDrugListID").removeClass("input-validation-error").addClass("valid")},fn_UpsertRatePlanPriceRule:function(){var t=!1,i=$("#frmUpsertRatePlanPrice").valid(),n;return planMaster.fn_ClientIdValidation()&&i&&(t=!0,n={},n.ClientBasicRulePriceID=$("#ClientBasicRulePriceID").val(),n.ClientBasicRuleSetID=$("#ClientBasicRuleSetID").val(),n.PriceSourceOptionID=$("#PriceSourceOptionID").val(),n.PriceBasicDrugListID=$("#PriceBasicDrugListID").val(),n.PercentAdjutment=$("#PercentAdjutment").val(),n.FlatPrice=$("#FlatPrice").val(),n.DispenseFee=$("#DispenseFee").val(),n.AdditionalFee=$("#AdditionalFee").val(),$.ajax({type:"POST",url:"/Plan/UpsertRatePlanPriceRule",data:n,success:function(n){n.search("sessionModel")>0?location.reload():n.messageId>0&&n.messageId==1&&(commanAjax.Fn_CommanAlert(n.message,"Alert!"),window.location.href="/Plan/PlanList?strValue=")}})),t},fn_GetUrl:function(){return"/Plan/FilteredPlanList"},fn_AddPlan:function(){$.get("/Plan/UpsertRatePlan",{PlanId:-1},function(n){n.search("sessionModel")>0?location.reload():($("#divPartialData").html(n),$("#modalSize").removeClass().addClass("modal-dialog md"),$("#THSCommanModalPopUp").modal("show"))})},fn_EditPlan:function(n){$("#dvClaimPartial").addClass("ajaxLoading");$.get("/Plan/UpsertRatePlan",{PlanId:n},function(n){n.search("sessionModel")>0?location.reload():($("#modalSize").removeClass().addClass("modal-dialog md"),$("#divPartialData").html(n),$("#THSCommanModalPopUp").modal("show"))}).done(function(){$("#dvClaimPartial").removeClass("ajaxLoading")})},fn_PlanAddSuccess:function(n){commanAjax.Fn_CommanAlert(n.message,"Alert!");n.messageId==1&&($("#THSCommanModalPopUp").modal("hide"),planMaster.fn_BindListOnLoad())},fn_AddPriceRule:function(n){$("#dvClaimPartial").addClass("ajaxLoading");$.get("/Plan/UpsertRatePlanPriceRule",{PlanId:n,PlanRuleId:-1},function(n){n.search("sessionModel")>0?location.reload():($("#modalSize").removeClass().addClass("modal-dialog sm"),$("#divPartialData").html(n),$("#THSCommanModalPopUp").modal("show"))}).done(function(){$("#dvClaimPartial").removeClass("ajaxLoading")})},fn_PlanPriceAddSuccess:function(n){commanAjax.Fn_CommanAlert(n.message,"Alert!");n.messageId==1&&($("#AddPlanPriceRuleModalPopUp").modal("hide"),planMaster.fn_BindPlanPricingRule(n.clientBasicRuleSetID))},fn_EditPlanPrice:function(n,t){$("#divPartialData").addClass("ajaxLoading");$.get("/Plan/UpsertRatePlanPriceRule",{PlanId:n,PlanRuleId:t},function(n){n.search("sessionModel")>0?location.reload():($("#divAddPlanPriceRule").html(n),$("#AddPlanPriceRuleModalPopUp").modal("show"))}).done(function(){$("#divPartialData").removeClass("ajaxLoading")})},fn_CloseCurrentModel:function(){setTimeout(function(){$("#tblRatePlan").find("tbody tr:first")!=undefined&&$("#tblRatePlan tbody tr:first").find("td").length>1&&$("#tblRatePlan tr.selected").click()},100)}};